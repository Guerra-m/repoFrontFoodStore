<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de Categor√≠as | Food Store</title>
    <link rel="stylesheet" href="/src/pages/admin/adminHome/admin.css">
    <link rel="stylesheet" href="categorias.css">
</head>

<body>

    <header class="topbar">
        <div class="logo">üçï Food Store</div>
        <nav class="topnav">
            <a href="#">Tienda</a>
            <a href="#">Panel Admin</a>
            <span class="user">Juan P√©rez</span>
            <button id="logout-btn" class="logout-btn">Cerrar Sesi√≥n</button>
        </nav>
    </header>

    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>Administraci√≥n</h3>
            <ul class="menu">
                <li><a href="/src/pages/admin/adminHome/adminHome.html">üìä Dashboard</a></li>
                <li class="active"><a href="categories.html">üìÅ Categor√≠as</a></li>
                <li><a href="#">üçî Productos</a></li>
                <li><a href="#">üì¶ Pedidos</a></li>
                <li><a href="#">üõçÔ∏è Ver Tienda</a></li>
            </ul>
        </aside>

        <!-- Main content -->
        <main class="main-content">
            <div class="header-table">
                <h2>Gesti√≥n de Categor√≠as</h2>
                <button id="btnNueva" class="btn-nueva">+ Nueva Categor√≠a</button>
            </div>

            <div class="tabla-container">
                <table id="tablaCategorias">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Imagen</th>
                            <th>Nombre</th>
                            <th>Descripci√≥n</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- filas din√°micas con TypeScript -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>
    <!-- Modal -->
    <div id="modalCategoria" class="modal oculto">
        <div class="modal-content">
            <h3 id="tituloModal">Nueva Categor√≠a</h3>
            <form id="formCategoria">
                <label>Nombre:</label>
                <input type="text" id="nombre" required>
    
                <label>Descripci√≥n:</label>
                <input type="text" id="descripcion" required>
    
                <label>Imagen (URL):</label>
                <input type="text" id="imagen" placeholder="https://..." required>
    
                <div class="modal-buttons">
                    <button type="submit" class="btn-guardar">Guardar</button>
                    <button type="button" id="btnCancelar" class="btn-cancelar">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    
    <!-- Modal Editar Categor√≠a -->
    <div id="modalEditarCategoria" class="modal oculto">
        <div class="modal-content editar">
            <div class="modal-header">
                <h3>Editar Categor√≠a</h3>
                <button id="cerrarEditar" class="cerrar-modal">‚úï</button>
            </div>
    
            <form id="formEditarCategoria">
                <label for="editarNombre">Nombre</label>
                <input type="text" id="editarNombre" required>
    
                <label for="editarDescripcion">Descripci√≥n</label>
                <textarea id="editarDescripcion" rows="3" required></textarea>
    
                <label for="editarImagen">URL de Imagen</label>
                <input type="text" id="editarImagen" placeholder="https://..." required>
    
                <button type="submit" class="btn-guardar-naranja">Guardar</button>
            </form>
        </div>
    </div>



    <script type="module" src="categories.ts"></script>
    <script type="module">
        import { logout, getUser } from '../../../utils/auth.js';

        document.addEventListener('DOMContentLoaded', () => {
            const user = getUser();

            // 1Ô∏è‚É£ Si no hay usuario, redirigir al login
            if (!user) {
                window.location.replace('/src/pages/auth/login/login.html');
                return; // Detener ejecuci√≥n
            }

            // 2Ô∏è‚É£ Si el rol no es admin, redirigir seg√∫n su rol real
            if (user.rol !== 'admin') {
                if (user.rol === 'cliente') {
                    window.location.replace('/src/pages/store/home/home.html');
                } else {
                    window.location.replace('/src/pages/auth/login/login.html');
                }
                return; // Detener ejecuci√≥n
            }

            // 3Ô∏è‚É£ Configurar logout
            document.getElementById('logout-btn')?.addEventListener('click', () => logout());

            // 4Ô∏è‚É£ Todo lo dem√°s de la p√°gina se ejecuta aqu√≠
            console.log('Admin logueado:', user);
        });
    </script>
</body>

</html>